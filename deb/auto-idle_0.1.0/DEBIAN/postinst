#!/bin/bash
set -e

APP_DIR="/usr/share/auto-idle"
VENV_DIR="$APP_DIR/venv"

echo "Setting up Auto Idle Power Switcher environment..."

# Create venv if it doesn't exist
if [ ! -d "$VENV_DIR" ]; then
    python3 -m venv "$VENV_DIR"
fi

# Upgrade pip inside venv
"$VENV_DIR/bin/pip" install --upgrade pip

# Install runtime dependencies
"$VENV_DIR/bin/pip" install PySide6

echo "Auto Idle Power Switcher setup complete."
